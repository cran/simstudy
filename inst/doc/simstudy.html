<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Keith S. Goldfeld" />

<meta name="date" content="2017-10-18" />

<title>Simulating study data</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Simulating study data</h1>
<h4 class="author"><em>Keith S. Goldfeld</em></h4>
<h4 class="date"><em>2017-10-18</em></h4>



<STYLE TYPE="text/css">
<!--
  td{
    font-family: Arial; 
    font-size: 8pt;
    height: 2px;
    padding:0px;
    cellpadding="0";
    cellspacing="0";
    text-align: center;
  }
  th {
    font-family: Arial; 
    font-size: 9pt;
    height: 20px;
    font-weight: bold;
    text-align: center;
  }
  table { 
    border-spacing: 0px;
    border-collapse: collapse;
  }
--->
</STYLE>
<p>Simulation using <code>simstudy</code> has two primary steps. First, the user <strong>defines</strong> the data elements of a data set. Second, the user <strong>generates</strong> the data, using the definitions in the first step. Additional functionality exists to simulate observed or randomized <strong>treatment assignment/exposures</strong>, to generate <strong>survival</strong> data, to create <strong>longitudinal/panel</strong> data, to create <strong>multi-level/hierarchical</strong> data, to create datasets with <strong>correlated variables</strong> based on a specified covariance structure, to <strong>merge</strong> datasets, to create data sets with <strong>missing</strong> data, and to create non-linear relationships with underlying <strong>spline</strong> curves.</p>
<div id="defining-the-data" class="section level2">
<h2>Defining the data</h2>
<p>The key to simulating data in <code>simstudy</code> is the creation of series of data definition tables that look like this:</p>
<table>
<thead>
<tr class="header">
<th align="left">varname</th>
<th align="left">formula</th>
<th align="right">variance</th>
<th align="left">dist</th>
<th align="left">link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">nr</td>
<td align="left">7</td>
<td align="right">0</td>
<td align="left">nonrandom</td>
<td align="left">identity</td>
</tr>
<tr class="even">
<td align="left">x1</td>
<td align="left">10;20</td>
<td align="right">0</td>
<td align="left">uniform</td>
<td align="left">identity</td>
</tr>
<tr class="odd">
<td align="left">y1</td>
<td align="left">nr + x1 * 2</td>
<td align="right">8</td>
<td align="left">normal</td>
<td align="left">identity</td>
</tr>
<tr class="even">
<td align="left">y2</td>
<td align="left">nr - 0.2 * x1</td>
<td align="right">0</td>
<td align="left">poisson</td>
<td align="left">log</td>
</tr>
<tr class="odd">
<td align="left">xCat</td>
<td align="left">0.3;0.2;0.5</td>
<td align="right">0</td>
<td align="left">categorical</td>
<td align="left">identity</td>
</tr>
<tr class="even">
<td align="left">g1</td>
<td align="left">5+xCat</td>
<td align="right">1</td>
<td align="left">gamma</td>
<td align="left">log</td>
</tr>
<tr class="odd">
<td align="left">a1</td>
<td align="left">-3 + xCat</td>
<td align="right">0</td>
<td align="left">binary</td>
<td align="left">logit</td>
</tr>
</tbody>
</table>
<p>These <em>definition</em> tables can be generated two ways. One option is to to use any external editor that allows the creation of <code>csv</code> files, which can be read in with a call to <code>defRead</code>. An alternative is to make repeated calls to the function <code>defData</code>. Here, we illustrate the R code that builds this definition table internally:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">def &lt;-<span class="st"> </span><span class="kw">defData</span>(<span class="dt">varname =</span> <span class="st">&quot;nr&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;nonrandom&quot;</span>, <span class="dt">formula =</span> <span class="dv">7</span>, <span class="dt">id =</span> <span class="st">&quot;idnum&quot;</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;x1&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;uniform&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;10;20&quot;</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;y1&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;nr + x1 * 2&quot;</span>, <span class="dt">variance =</span> <span class="dv">8</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;y2&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;poisson&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;nr - 0.2 * x1&quot;</span>, 
    <span class="dt">link =</span> <span class="st">&quot;log&quot;</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;xCat&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;0.3;0.2;0.5&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;categorical&quot;</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;g1&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;gamma&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;5+xCat&quot;</span>, <span class="dt">variance =</span> <span class="dv">1</span>, 
    <span class="dt">link =</span> <span class="st">&quot;log&quot;</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;a1&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;-3 + xCat&quot;</span>, 
    <span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>)</code></pre></div>
<p>The first call to <code>defData</code> without specifying a definition name (in this example the definition name is <em>def</em>) creates a <strong>new</strong> data.table with a single row. An additional row is added to the table <code>def</code> each time the function <code>defData</code> is called. Each of these calls is the definition of a new field in the data set that will be generated. In this example, the first data field is named ‘nr’, defined as a constant with a value to be 7. In each call to <code>defData</code> the user defines a variable name, a distribution (the default is ‘normal’), a mean formula (if applicable), a variance parameter (if applicable), and a link function for the mean (defaults to ‘identity’).<br />
The possible distributions include <strong>normal</strong>, <strong>gamma</strong>, <strong>poisson</strong>, <strong>zero-truncated poisson</strong>, <strong>binary</strong>, <strong>uniform</strong>, <strong>uniform integer</strong>, <strong>categorical</strong>, and <strong>deterministic/non-random</strong>. For all of these distributions, key parameters defining the distribution are entered in the <code>formula</code>, <code>variance</code>, and <code>link</code> fields.</p>
<p>In the case of the <strong>normal</strong> and <strong>gamma</strong> distributions, the formula specifies the mean. The formula can be a scalar value (number) or a string that represents a function of previously defined variables in the data set definition (or, as we will see later, in a previously generated data set). In the example, the mean of <code>y1</code>, a normally distributed value, is declared as a linear function of <code>nr</code> and <code>x1</code>, and the mean of <code>g1</code> is a function of the category defined by <code>xCat</code>. The <code>variance</code> field is defined only for normal and gamma random variables, and can only be defined as a scalar value. In the case of gamma random variables, the value entered in variance field is really a dispersion value <span class="math inline">\(d\)</span>, where the actual variance will be <span class="math inline">\(d \times mean^2\)</span>.<br />
</p>
<p>In the case of the <strong>poisson</strong>, <strong>zero-truncated poisson</strong>, and <strong>binary</strong> distributions, the formula also specifies the mean. The variance is not a valid parameter in these cases, but the <code>link</code> field is. The default link is ‘identity’ but a ‘log’ link is available for the Poisson distributions and a “logit” link is available for the binary outcomes. In this example, <code>y2</code> is defined as Poisson random variable with a mean that is function of <code>nr</code> and <code>x1</code> on the log scale. For binary variables, which take a value of 0 or 1, the formula represents probability (with the ‘identity’ link) or log odds (with the ‘logit’ link) of the variable having a value of 1. In the example, <code>a1</code> has been defined as a binary random variable with a log odds that is a function of <code>xCat</code>.<br />
<br />
Variables defined with a <strong>uniform</strong>, <strong>uniform integer</strong>, <strong>categorical</strong>, or <strong>deterministic/non-random</strong> distribution are specified using the formula only. The <code>variance</code> and <code>link</code> fields are not used in these cases.<br />
<br />
For a uniformly distributed variable, The formula is a string with the format “a;b”, where <em>a</em> and <em>b</em> are scalars or functions of previously defined variables. The uniform distribution has two parameters - the minimum and the maximum. In this case, <em>a</em> represents the minimum and <em>b</em> represents the maximum.<br />
<br />
For a categorical variable with <span class="math inline">\(k\)</span> categories, the formula is a string of probabilities that sum to 1: “<span class="math inline">\(p_1 ; p_2 ; ... ; p_k\)</span>”. <span class="math inline">\(p_1\)</span> is the probability of the random variable falling category 1, <span class="math inline">\(p_2\)</span> is the probability of category 2, etc. The probabilities can be specified as functions of other variables previously defined. In the example, <code>xCat</code> has three possibilities with probabilities 0.3, 0.2, and 0.5, respectively.<br />
<br />
Non-random variables are defined by the formula. Since these variables are deterministic, variance is not relevant. They can be functions of previously defined variables or a scalar, as we see in the sample for variable defined as <code>nr</code>.</p>
</div>
<div id="generating-the-data" class="section level2">
<h2>Generating the data</h2>
<p>After the data set definitions have been created, a new data set with <span class="math inline">\(n\)</span> observations can be created with a call to function <strong><code>genData</code></strong>. In this example, 1,000 observations are generated using the data set definitions in <strong><code>def</code></strong>, and then stored in the object <strong><code>dt</code></strong>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt &lt;-<span class="st"> </span><span class="kw">genData</span>(<span class="dv">1000</span>, def)
dt</code></pre></div>
<pre><code>##       idnum nr       x1       y1  y2 xCat         g1 a1
##    1:     1  7 18.71470 48.13110  25    1 1104.82145  0
##    2:     2  7 12.63977 34.82680  87    2  222.26269  1
##    3:     3  7 13.21247 34.96022  80    1  289.08795  0
##    4:     4  7 19.21613 38.93975  17    3 1218.53035  0
##    5:     5  7 10.70988 24.16021 148    1 1011.98398  0
##   ---                                                  
##  996:   996  7 12.69114 34.43474  88    3 1007.88648  0
##  997:   997  7 11.48129 31.34903 108    3 4146.61939  0
##  998:   998  7 16.88184 41.60436  45    1   27.90073  0
##  999:   999  7 10.24263 25.36589 151    3 4626.50014  0
## 1000:  1000  7 12.72076 33.53079  78    1   37.97592  0</code></pre>
<p>New data can be added to an existing data set with a call to function <strong><code>addColumns</code></strong>. The new data definitions are created with a call to <strong><code>defData</code></strong> and then included as an argument in the call to <strong><code>addColumns</code></strong>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">addef &lt;-<span class="st"> </span><span class="kw">defDataAdd</span>(<span class="dt">varname =</span> <span class="st">&quot;zExtra&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;3 + y1&quot;</span>, 
    <span class="dt">variance =</span> <span class="dv">2</span>)

dt &lt;-<span class="st"> </span><span class="kw">addColumns</span>(addef, dt)
dt</code></pre></div>
<pre><code>##       idnum nr       x1       y1  y2 xCat         g1 a1   zExtra
##    1:     1  7 18.71470 48.13110  25    1 1104.82145  0 51.82939
##    2:     2  7 12.63977 34.82680  87    2  222.26269  1 38.09525
##    3:     3  7 13.21247 34.96022  80    1  289.08795  0 37.20631
##    4:     4  7 19.21613 38.93975  17    3 1218.53035  0 41.14921
##    5:     5  7 10.70988 24.16021 148    1 1011.98398  0 26.37784
##   ---                                                           
##  996:   996  7 12.69114 34.43474  88    3 1007.88648  0 36.83071
##  997:   997  7 11.48129 31.34903 108    3 4146.61939  0 37.31045
##  998:   998  7 16.88184 41.60436  45    1   27.90073  0 45.54451
##  999:   999  7 10.24263 25.36589 151    3 4626.50014  0 30.51333
## 1000:  1000  7 12.72076 33.53079  78    1   37.97592  0 35.63998</code></pre>
</div>
<div id="generating-the-treatmentexposure" class="section level2">
<h2>Generating the treatment/exposure</h2>
<p>Treatment assignment can be accomplished through the original data generation process, using <code>defData</code> and <code>genData</code>. However, the functions <code>trtAssign</code> and <code>trtObserve</code> provide more options to generate treatment assignment.</p>
<div id="assigned-treatment" class="section level3">
<h3>Assigned treatment</h3>
<p>Treatment assignment can simulate how treatment is made in a randomized study. Assignment to treatment groups can be (close to) balanced (as would occur in a block randomized trial); this balancing can be done without or without strata. Alternatively, the assignment can be left to chance without blocking; in this case, balance across treatment groups is not guaranteed, particularly with small sample sizes.</p>
<p>First, create the data definition:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">def &lt;-<span class="st"> </span><span class="kw">defData</span>(<span class="dt">varname =</span> <span class="st">&quot;male&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="dt">formula =</span> <span class="fl">0.5</span>, <span class="dt">id =</span> <span class="st">&quot;cid&quot;</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;over65&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;-1.7 + .8*male&quot;</span>, 
    <span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;baseDBP&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="dv">70</span>, <span class="dt">variance =</span> <span class="dv">40</span>)

dtstudy &lt;-<span class="st"> </span><span class="kw">genData</span>(<span class="dv">330</span>, def)</code></pre></div>
<p><em>Balanced treatment assignment, stratified by gender and age category (not blood pressure)</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study1 &lt;-<span class="st"> </span><span class="kw">trtAssign</span>(dtstudy, <span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">balanced =</span> <span class="ot">TRUE</span>, <span class="dt">strata =</span> <span class="kw">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;over65&quot;</span>), 
    <span class="dt">grpName =</span> <span class="st">&quot;rxGrp&quot;</span>)

study1</code></pre></div>
<pre><code>##      cid rxGrp male over65  baseDBP
##   1:   1     1    1      0 70.51994
##   2:   2     3    1      0 68.37788
##   3:   3     2    1      0 68.91449
##   4:   4     3    1      1 58.65074
##   5:   5     3    1      1 59.28269
##  ---                               
## 326: 326     1    1      0 61.63004
## 327: 327     2    0      0 78.49473
## 328: 328     2    0      0 71.21033
## 329: 329     3    1      0 71.90673
## 330: 330     2    0      0 67.42199</code></pre>
<p><em>Balanced treatment assignment (without stratification)</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study2 &lt;-<span class="st"> </span><span class="kw">trtAssign</span>(dtstudy, <span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">balanced =</span> <span class="ot">TRUE</span>, <span class="dt">grpName =</span> <span class="st">&quot;rxGrp&quot;</span>)</code></pre></div>
<p><em>Random (unbalanced) treatment assignment</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">study3 &lt;-<span class="st"> </span><span class="kw">trtAssign</span>(dtstudy, <span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">balanced =</span> <span class="ot">FALSE</span>, <span class="dt">grpName =</span> <span class="st">&quot;rxGrp&quot;</span>)</code></pre></div>
<p><em>Comparison of three treatment assignment mechanisms</em> <img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="observed-treatment" class="section level3">
<h3>Observed treatment</h3>
<p>If exposure or treatment is observed (rather than randomly assigned), use <code>trtObserve</code> to generate groups. There may be any number of possible exposure or treatment groups, and the probability of exposure to a specific level can depend on covariates already in the data set. In this case, there are three exposure groups that vary by gender and age:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">formula1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;-2 + 2*male - .5*over65&quot;</span>, <span class="st">&quot;-1 + 2*male + .5*over65&quot;</span>)
dtExp &lt;-<span class="st"> </span><span class="kw">trtObserve</span>(dtstudy, <span class="dt">formulas =</span> formula1, <span class="dt">logit.link =</span> <span class="ot">TRUE</span>, <span class="dt">grpName =</span> <span class="st">&quot;exposure&quot;</span>)</code></pre></div>
<p>Here are the exposure distributions by gender and age:</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here is a second case of three exposures where the exposure is independent of any covariates. Note that specifying the formula as <code>c(.35, .45)</code> is the same as specifying it is <code>c(.35, .45, .20)</code>. Also, when referring to probabilities, the identity link is used:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">formula2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.35</span>, <span class="fl">0.45</span>)

dtExp2 &lt;-<span class="st"> </span><span class="kw">trtObserve</span>(dtstudy, <span class="dt">formulas =</span> formula2, <span class="dt">logit.link =</span> <span class="ot">FALSE</span>, <span class="dt">grpName =</span> <span class="st">&quot;exposure&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="survival-data-updated-10-11-2017" class="section level2">
<h2>Survival data (updated 10-11-2017)</h2>
<p>Time-to-event data, including both survival and censoring times, are created using functions <code>defSurv</code> and <code>genSurv</code>. The survival data definitions require a variable name as well as a specification of a scale value, which determines the mean survival time at a baseline level of covariates (i.e. all covariates set to 0). The Weibull distribution is used to generate these survival times. In addition, covariates (which have been defined previously) that influence survival time can be included in the <code>formula</code> field. Positive coefficients are associated with longer survival times (and lower hazard rates). Finally, the <em>shape</em> of the distribution can be specified. A <code>shape</code> value of 1 reflects the <em>exponential</em> distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Baseline data definitions</span>

def &lt;-<span class="st"> </span><span class="kw">defData</span>(<span class="dt">varname =</span> <span class="st">&quot;x1&quot;</span>, <span class="dt">formula =</span> <span class="fl">0.5</span>, <span class="dt">dist =</span> <span class="st">&quot;binary&quot;</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;x2&quot;</span>, <span class="dt">formula =</span> <span class="fl">0.5</span>, <span class="dt">dist =</span> <span class="st">&quot;binary&quot;</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;grp&quot;</span>, <span class="dt">formula =</span> <span class="fl">0.5</span>, <span class="dt">dist =</span> <span class="st">&quot;binary&quot;</span>)

<span class="co"># Survival data definitions</span>

sdef &lt;-<span class="st"> </span><span class="kw">defSurv</span>(<span class="dt">varname =</span> <span class="st">&quot;survTime&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;1.5*x1&quot;</span>, <span class="dt">scale =</span> <span class="st">&quot;grp*50 + (1-grp)*25&quot;</span>, 
    <span class="dt">shape =</span> <span class="st">&quot;grp*1 + (1-grp)*1.5&quot;</span>)
sdef &lt;-<span class="st"> </span><span class="kw">defSurv</span>(sdef, <span class="dt">varname =</span> <span class="st">&quot;censorTime&quot;</span>, <span class="dt">scale =</span> <span class="dv">80</span>, <span class="dt">shape =</span> <span class="dv">1</span>)

sdef</code></pre></div>
<pre><code>##       varname formula               scale               shape
## 1:   survTime  1.5*x1 grp*50 + (1-grp)*25 grp*1 + (1-grp)*1.5
## 2: censorTime       0                  80                   1</code></pre>
<p>The data are generated with calls to <code>genData</code> and <code>genSurv</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Baseline data definitions</span>

dtSurv &lt;-<span class="st"> </span><span class="kw">genData</span>(<span class="dv">300</span>, def)
dtSurv &lt;-<span class="st"> </span><span class="kw">genSurv</span>(dtSurv, sdef)

<span class="kw">head</span>(dtSurv)</code></pre></div>
<pre><code>##    id x1 x2 grp survTime censorTime
## 1:  1  1  1   1   18.907     21.489
## 2:  2  1  0   1    8.068     31.568
## 3:  3  0  1   0    1.091    539.314
## 4:  4  0  1   1   25.625     10.591
## 5:  5  0  0   1   56.257     16.691
## 6:  6  0  0   1  169.369     84.315</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A comparison of survival by group and x1</span>

dtSurv[, <span class="kw">round</span>(<span class="kw">mean</span>(survTime), <span class="dv">1</span>), keyby =<span class="st"> </span>.(grp, x1)]</code></pre></div>
<pre><code>##    grp x1    V1
## 1:   0  0 200.8
## 2:   0  1  16.1
## 3:   1  0  53.8
## 4:   1  1  11.0</code></pre>
<p>Observed survival times and censoring indicators can be generated by defining new fields:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cdef &lt;-<span class="st"> </span><span class="kw">defDataAdd</span>(<span class="dt">varname =</span> <span class="st">&quot;obsTime&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;pmin(survTime, censorTime)&quot;</span>, 
    <span class="dt">dist =</span> <span class="st">&quot;nonrandom&quot;</span>)
cdef &lt;-<span class="st"> </span><span class="kw">defDataAdd</span>(cdef, <span class="dt">varname =</span> <span class="st">&quot;status&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;I(survTime &lt;= censorTime)&quot;</span>, 
    <span class="dt">dist =</span> <span class="st">&quot;nonrandom&quot;</span>)

dtSurv &lt;-<span class="st"> </span><span class="kw">addColumns</span>(cdef, dtSurv)

<span class="kw">head</span>(dtSurv)</code></pre></div>
<pre><code>##    id x1 x2 grp survTime censorTime obsTime status
## 1:  1  1  1   1   18.907     21.489  18.907      1
## 2:  2  1  0   1    8.068     31.568   8.068      1
## 3:  3  0  1   0    1.091    539.314   1.091      1
## 4:  4  0  1   1   25.625     10.591  10.591      0
## 5:  5  0  0   1   56.257     16.691  16.691      0
## 6:  6  0  0   1  169.369     84.315  84.315      0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># estimate proportion of censoring by x1 and group</span>

dtSurv[, <span class="kw">round</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(status), <span class="dv">2</span>), keyby =<span class="st"> </span>.(grp, x1)]</code></pre></div>
<pre><code>##    grp x1   V1
## 1:   0  0 0.60
## 2:   0  1 0.16
## 3:   1  0 0.39
## 4:   1  1 0.13</code></pre>
<p>Here is a Kaplan-Meier plot of the data by the four groups:</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="longitudinal-data" class="section level2">
<h2>Longitudinal data</h2>
<p>To simulate longitudinal data, we start with a ‘cross-sectional’ data set and convert it to a time-dependent data set. The original cross-sectional data set may or may not include time-dependent data in the columns. In the next example, we measure outcome <code>Y</code> once before and twice after intervention <code>T</code> in a randomized trial:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tdef &lt;-<span class="st"> </span><span class="kw">defData</span>(<span class="dt">varname =</span> <span class="st">&quot;T&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="dt">formula =</span> <span class="fl">0.5</span>)
tdef &lt;-<span class="st"> </span><span class="kw">defData</span>(tdef, <span class="dt">varname =</span> <span class="st">&quot;Y0&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="dv">10</span>, <span class="dt">variance =</span> <span class="dv">1</span>)
tdef &lt;-<span class="st"> </span><span class="kw">defData</span>(tdef, <span class="dt">varname =</span> <span class="st">&quot;Y1&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;Y0 + 5 + 5 * T&quot;</span>, 
    <span class="dt">variance =</span> <span class="dv">1</span>)
tdef &lt;-<span class="st"> </span><span class="kw">defData</span>(tdef, <span class="dt">varname =</span> <span class="st">&quot;Y2&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;Y0 + 10 + 5 * T&quot;</span>, 
    <span class="dt">variance =</span> <span class="dv">1</span>)

dtTrial &lt;-<span class="st"> </span><span class="kw">genData</span>(<span class="dv">500</span>, tdef)
dtTrial</code></pre></div>
<pre><code>##       id T        Y0       Y1       Y2
##   1:   1 0  9.183977 13.94165 17.27805
##   2:   2 1  8.643123 18.82474 22.37659
##   3:   3 1 10.324793 19.35620 25.71761
##   4:   4 0 10.282520 16.10805 20.92872
##   5:   5 1  9.657632 20.49713 22.13235
##  ---                                  
## 496: 496 0 10.430134 15.00519 20.56333
## 497: 497 0  9.801622 17.45522 19.28969
## 498: 498 1 12.034422 21.22105 28.24692
## 499: 499 1  9.359974 18.83581 25.33157
## 500: 500 0  8.817763 14.18292 20.04614</code></pre>
<p>The data in longitudinal form is created with a call to <strong><code>addPeriods</code></strong>. If the cross-sectional data includes time dependent data, then the number of periods <code>nPeriods</code> must be the same as the number of time dependent columns. If a variable is not declared as one of the <code>timevars</code>, it will be repeated each time period. In this example, the treatment indicator <code>T</code> is not specified as a time dependent variable. (Note: if there are two time-dependent variables, it is best to create two data sets and merge them. This will be shown later in the vignette).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dtTime &lt;-<span class="st"> </span><span class="kw">addPeriods</span>(dtTrial, <span class="dt">nPeriods =</span> <span class="dv">3</span>, <span class="dt">idvars =</span> <span class="st">&quot;id&quot;</span>, <span class="dt">timevars =</span> <span class="kw">c</span>(<span class="st">&quot;Y0&quot;</span>, 
    <span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>), <span class="dt">timevarName =</span> <span class="st">&quot;Y&quot;</span>)
dtTime</code></pre></div>
<p>This is what the longitudinal data look like:</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="longitudinal-data-with-varying-observation-and-interval-times" class="section level3">
<h3>Longitudinal data with varying observation and interval times</h3>
<p>It is also possible to generate longitudinal data with varying numbers of measurement periods as well as varying time intervals between each measurement period. This is done by defining specific variables in the data set that define the number of observations per subject and the average interval time between each observation. <code>nCount</code> defines the number of measurements for an individual; <code>mInterval</code> specifies the average time between intervals for an subject; and <code>vInterval</code> specifies the variance of those interval times. If <code>vInterval</code> is set to 0 or is not defined, the interval for a subject is determined entirely by the mean interval. If <code>vInterval</code> is greater than 0, time intervals are generated using a gamma distribution with mean and dispersion specified.</p>
<p>In this simple example, the cross-sectional data generates individuals with a different number of measurement observations and different times between each observation. Data for two of these individuals is printed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">def &lt;-<span class="st"> </span><span class="kw">defData</span>(<span class="dt">varname =</span> <span class="st">&quot;xbase&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="dv">20</span>, <span class="dt">variance =</span> <span class="dv">3</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;nCount&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;noZeroPoisson&quot;</span>, <span class="dt">formula =</span> <span class="dv">6</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;mInterval&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;gamma&quot;</span>, <span class="dt">formula =</span> <span class="dv">30</span>, <span class="dt">variance =</span> <span class="fl">0.01</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;vInterval&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;nonrandom&quot;</span>, <span class="dt">formula =</span> <span class="fl">0.07</span>)

dt &lt;-<span class="st"> </span><span class="kw">genData</span>(<span class="dv">200</span>, def)
dt[id <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">8</span>, <span class="dv">121</span>)]  <span class="co"># View individuals 8 and 121</span></code></pre></div>
<pre><code>##     id    xbase nCount mInterval vInterval
## 1:   8 18.24515      5  33.84171      0.07
## 2: 121 17.33932      5  27.60829      0.07</code></pre>
<p>The resulting longitudinal data for these two subjects can be inspected after a call to <code>addPeriods</code>. Notice that no parameters need to be set since all information resides in the data set itself:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dtPeriod &lt;-<span class="st"> </span><span class="kw">addPeriods</span>(dt)
dtPeriod[id <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">8</span>, <span class="dv">121</span>)]  <span class="co"># View individuals 8 and 121 only</span></code></pre></div>
<pre><code>##      id period    xbase time timeID
##  1:   8      0 18.24515    0     49
##  2:   8      1 18.24515   56     50
##  3:   8      2 18.24515  107     51
##  4:   8      3 18.24515  151     52
##  5:   8      4 18.24515  180     53
##  6: 121      0 17.33932    0    753
##  7: 121      1 17.33932   14    754
##  8: 121      2 17.33932   37    755
##  9: 121      3 17.33932   66    756
## 10: 121      4 17.33932   94    757</code></pre>
<p>If a time sensitive measurement is added to the data set …</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">def2 &lt;-<span class="st"> </span><span class="kw">defDataAdd</span>(<span class="dt">varname =</span> <span class="st">&quot;Y&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;15 + .1 * time&quot;</span>, 
    <span class="dt">variance =</span> <span class="dv">5</span>)
dtPeriod &lt;-<span class="st"> </span><span class="kw">addColumns</span>(def2, dtPeriod)</code></pre></div>
<p>… a plot of a five randomly selected individuals looks like this:</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="clustered-data" class="section level2">
<h2>Clustered data</h2>
<p>The function <code>genCluster</code> generates multilevel or clustered data based on a previously generated data set that is one “level” up from the clustered data. For example, if there is a data set that contains school level (considered here to be level 2), classrooms (level 1) can be generated. And then, students (now level 1) can be generated within classrooms (now level 2)</p>
<p>In the example here, we do in fact generate school, class, and student level data. There are eight schools, four of which are randomized to receive an intervention. The number of classes per school varies, as does the number of students per class. (It is straightforward to generate fully balanced data by using constant values.) The outcome of interest is a test score, which is influenced by gender and the intervention. In addition, test scores vary by schools, and by classrooms, so the simulation provides <em>random effects</em> at each of these levels.</p>
<p>We start by defining the school level data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gen.school &lt;-<span class="st"> </span><span class="kw">defData</span>(<span class="dt">varname =</span> <span class="st">&quot;s0&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="dv">0</span>, <span class="dt">variance =</span> <span class="dv">3</span>, 
    <span class="dt">id =</span> <span class="st">&quot;idSchool&quot;</span>)
gen.school &lt;-<span class="st"> </span><span class="kw">defData</span>(gen.school, <span class="dt">varname =</span> <span class="st">&quot;nClasses&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;noZeroPoisson&quot;</span>, 
    <span class="dt">formula =</span> <span class="dv">3</span>)

dtSchool &lt;-<span class="st"> </span><span class="kw">genData</span>(<span class="dv">8</span>, gen.school)
dtSchool &lt;-<span class="st"> </span><span class="kw">trtAssign</span>(dtSchool, <span class="dt">n =</span> <span class="dv">2</span>)

dtSchool</code></pre></div>
<p>The classroom level data are generated with a call to <code>genCluster</code>, and then school level data is added by a call to <code>addColumns</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gen.class &lt;-<span class="st"> </span><span class="kw">defDataAdd</span>(<span class="dt">varname =</span> <span class="st">&quot;c0&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="dv">0</span>, <span class="dt">variance =</span> <span class="dv">2</span>)
gen.class &lt;-<span class="st"> </span><span class="kw">defDataAdd</span>(gen.class, <span class="dt">varname =</span> <span class="st">&quot;nStudents&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;noZeroPoisson&quot;</span>, 
    <span class="dt">formula =</span> <span class="dv">20</span>)

dtClass &lt;-<span class="st"> </span><span class="kw">genCluster</span>(dtSchool, <span class="st">&quot;idSchool&quot;</span>, <span class="dt">numIndsVar =</span> <span class="st">&quot;nClasses&quot;</span>, <span class="dt">level1ID =</span> <span class="st">&quot;idClass&quot;</span>)
dtClass &lt;-<span class="st"> </span><span class="kw">addColumns</span>(gen.class, dtClass)

<span class="kw">head</span>(dtClass, <span class="dv">10</span>)</code></pre></div>
<pre><code>##     idSchool trtGrp        s0 nClasses idClass         c0 nStudents
##  1:        1      0  4.507355        3       1 -1.7030717        19
##  2:        1      0  4.507355        3       2  0.9972415        19
##  3:        1      0  4.507355        3       3  0.6907191        19
##  4:        2      1 -1.774387        2       4  1.2638098        17
##  5:        2      1 -1.774387        2       5 -0.2549515        27
##  6:        3      1 -2.245730        5       6 -0.1392407        16
##  7:        3      1 -2.245730        5       7  0.9852097        17
##  8:        3      1 -2.245730        5       8  0.0693371        20
##  9:        3      1 -2.245730        5       9 -0.6584024        17
## 10:        3      1 -2.245730        5      10 -1.1545564         8</code></pre>
<p>Finally, the student level data are added using the same process:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gen.student &lt;-<span class="st"> </span><span class="kw">defDataAdd</span>(<span class="dt">varname =</span> <span class="st">&quot;Male&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;binary&quot;</span>, 
    <span class="dt">formula =</span> <span class="fl">0.5</span>)
gen.student &lt;-<span class="st"> </span><span class="kw">defDataAdd</span>(gen.student, <span class="dt">varname =</span> <span class="st">&quot;age&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;uniform&quot;</span>, 
    <span class="dt">formula =</span> <span class="st">&quot;9.5; 10.5&quot;</span>)
gen.student &lt;-<span class="st"> </span><span class="kw">defDataAdd</span>(gen.student, <span class="dt">varname =</span> <span class="st">&quot;test&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, 
    <span class="dt">formula =</span> <span class="st">&quot;50 - 5*Male + s0 + c0 + 8 * trtGrp&quot;</span>, <span class="dt">variance =</span> <span class="dv">2</span>)
dtStudent &lt;-<span class="st"> </span><span class="kw">genCluster</span>(dtClass, <span class="dt">cLevelVar =</span> <span class="st">&quot;idClass&quot;</span>, <span class="dt">numIndsVar =</span> <span class="st">&quot;nStudents&quot;</span>, 
    <span class="dt">level1ID =</span> <span class="st">&quot;idChild&quot;</span>)

dtStudent &lt;-<span class="st"> </span><span class="kw">addColumns</span>(gen.student, dtStudent)</code></pre></div>
<p>This is what the clustered data look like. Each classroom is represented by a box, and each school is represented by a color. The intervention group is highlighted by dark outlines:</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="correlated-data" class="section level2">
<h2>Correlated data</h2>
<p>Sometimes it is desirable to simulate correlated data from a correlation matrix directly. For example, a simulation might require two random effects (e.g. a random intercept and a random slope). Correlated data like this could be generated using the <code>defData</code> functionality, but it may be more natural to do this with <code>genCorData</code> or <code>addCorData</code>. Currently, simstudy can only generate multivariate normal using these functions. (In the future, additional distributions will be available.)</p>
<p><code>genCorData</code> requires the user to specify a mean vector <code>mu</code>, a single standard deviation or a vector of standard deviations <code>sigma</code>, and either a correlation matrix <code>corMatrix</code> or a correlation coefficient <code>rho</code> and a correlation structure <code>corsrt</code>. It is easy to see how this can be used from a few different examples.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># specifying a specific correlation matrix C</span>
C &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.7</span>, <span class="fl">0.2</span>, <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="dv">1</span>), <span class="dt">nrow =</span> <span class="dv">3</span>)
C</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  1.0  0.7  0.2
## [2,]  0.7  1.0  0.8
## [3,]  0.2  0.8  1.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># generate 3 correlated variables with different location and scale for each</span>
<span class="co"># field</span>
dt &lt;-<span class="st"> </span><span class="kw">genCorData</span>(<span class="dv">1000</span>, <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">3</span>), <span class="dt">sigma =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">corMatrix =</span> C)
dt</code></pre></div>
<pre><code>##         id       V1       V2       V3
##    1:    1 4.961148 13.26393 2.840141
##    2:    2 4.423707 11.26632 0.585865
##    3:    3 4.505243 15.10431 7.953057
##    4:    4 5.912019 15.65229 7.284611
##    5:    5 3.803263 12.48040 5.799542
##   ---                                
##  996:  996 3.961720 11.35413 2.382481
##  997:  997 4.916326 14.18447 1.751163
##  998:  998 2.706845 12.50867 5.476521
##  999:  999 4.390748 13.11972 6.536869
## 1000: 1000 3.129428 12.07712 4.054305</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># estimate correlation matrix</span>
dt[, <span class="kw">round</span>(<span class="kw">cor</span>(<span class="kw">cbind</span>(V1, V2, V3)), <span class="dv">1</span>)]</code></pre></div>
<pre><code>##     V1  V2  V3
## V1 1.0 0.7 0.2
## V2 0.7 1.0 0.8
## V3 0.2 0.8 1.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># estimate standard deviation</span>
dt[, <span class="kw">round</span>(<span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">var</span>(<span class="kw">cbind</span>(V1, V2, V3)))), <span class="dv">1</span>)]</code></pre></div>
<pre><code>##  V1  V2  V3 
## 1.0 2.0 3.1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># generate 3 correlated variables with different location but same standard</span>
<span class="co"># deviation and compound symmetry (cs) correlation matrix with correlation</span>
<span class="co"># coefficient = 0.4.  Other correlation matrix structures are 'independent'</span>
<span class="co"># ('ind') and 'auto-regressive' ('ar1').</span>

dt &lt;-<span class="st"> </span><span class="kw">genCorData</span>(<span class="dv">1000</span>, <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">3</span>), <span class="dt">sigma =</span> <span class="dv">3</span>, <span class="dt">rho =</span> <span class="fl">0.4</span>, <span class="dt">corstr =</span> <span class="st">&quot;cs&quot;</span>, 
    <span class="dt">cnames =</span> <span class="kw">c</span>(<span class="st">&quot;x0&quot;</span>, <span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>))
dt</code></pre></div>
<pre><code>##         id          x0        x1        x2
##    1:    1  4.01680174 10.988722  4.660781
##    2:    2  3.89840654  8.077716 -2.126860
##    3:    3  4.74746283 12.954511  5.061043
##    4:    4  2.72664496  9.057147  1.780203
##    5:    5  5.11602828  8.996474  3.785076
##   ---                                     
##  996:  996 -0.08578829 16.939107 -2.640823
##  997:  997  1.49325898 17.618566  4.783375
##  998:  998  6.54808015 16.928090  6.634765
##  999:  999 -3.48470389  5.338074 -2.624562
## 1000: 1000  5.86833766 14.015090  3.513920</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># estimate correlation matrix</span>
dt[, <span class="kw">round</span>(<span class="kw">cor</span>(<span class="kw">cbind</span>(x0, x1, x2)), <span class="dv">1</span>)]</code></pre></div>
<pre><code>##     x0  x1  x2
## x0 1.0 0.4 0.4
## x1 0.4 1.0 0.4
## x2 0.4 0.4 1.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># estimate standard deviation</span>
dt[, <span class="kw">round</span>(<span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">var</span>(<span class="kw">cbind</span>(x0, x1, x2)))), <span class="dv">1</span>)]</code></pre></div>
<pre><code>## x0 x1 x2 
##  3  3  3</code></pre>
<p>The new data generated by <code>genCorData</code> can be merged with an existing data set. Alternatively, <code>addCorData</code> will do this directly:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define and generate the original data set</span>
def &lt;-<span class="st"> </span><span class="kw">defData</span>(<span class="dt">varname =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="dv">0</span>, <span class="dt">variance =</span> <span class="dv">1</span>, <span class="dt">id =</span> <span class="st">&quot;cid&quot;</span>)
dt &lt;-<span class="st"> </span><span class="kw">genData</span>(<span class="dv">1000</span>, def)

<span class="co"># add new correlate fields a0 and a1 to 'dt'</span>
dt &lt;-<span class="st"> </span><span class="kw">addCorData</span>(dt, <span class="dt">idname =</span> <span class="st">&quot;cid&quot;</span>, <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">sigma =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="fl">0.2</span>), <span class="dt">rho =</span> <span class="op">-</span><span class="fl">0.2</span>, 
    <span class="dt">corstr =</span> <span class="st">&quot;cs&quot;</span>, <span class="dt">cnames =</span> <span class="kw">c</span>(<span class="st">&quot;a0&quot;</span>, <span class="st">&quot;a1&quot;</span>))

dt</code></pre></div>
<pre><code>##        cid          x         a0           a1
##    1:    1 -2.0674678  1.4789095  0.017142855
##    2:    2 -0.1657663  0.2225743 -0.283654340
##    3:    3 -0.6312775 -2.0066948  0.307710348
##    4:    4 -0.2731647 -0.2291039 -0.008029806
##    5:    5  0.6503149  0.7722605  0.051692272
##   ---                                        
##  996:  996 -1.6173502  1.6193290  0.264729636
##  997:  997  0.5800576  3.0704741 -0.189104878
##  998:  998 -0.8780534 -1.1827028  0.205045502
##  999:  999  0.6098744 -0.2799536 -0.197636517
## 1000: 1000  0.2650545  0.6857319  0.057613168</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># estimate correlation matrix</span>
dt[, <span class="kw">round</span>(<span class="kw">cor</span>(<span class="kw">cbind</span>(a0, a1)), <span class="dv">1</span>)]</code></pre></div>
<pre><code>##      a0   a1
## a0  1.0 -0.2
## a1 -0.2  1.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># estimate standard deviation</span>
dt[, <span class="kw">round</span>(<span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">var</span>(<span class="kw">cbind</span>(a0, a1)))), <span class="dv">1</span>)]</code></pre></div>
<pre><code>##  a0  a1 
## 2.0 0.2</code></pre>
<div id="correlated-data-additional-distributions" class="section level3">
<h3>Correlated data: additional distributions</h3>
<p>Two additional functions facilitate the generation of correlated data from <em>binomial</em>, <em>poisson</em>, <em>gamma</em>, and <em>uniform</em> distributions: <code>genCorGen</code> and <code>addCorGen</code>.</p>
<p><code>genCorGen</code> is an extension of <code>genCorData</code>. In the first example, we are generating data from a multivariate Poisson distribution. We start by specifying the mean of the Poisson distribution for each new variable, and then we specify the correlation structure, just as we did with the normal distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>)  <span class="co"># lambda for each new variable</span>

dx &lt;-<span class="st"> </span><span class="kw">genCorGen</span>(<span class="dv">1000</span>, <span class="dt">nvars =</span> <span class="dv">3</span>, <span class="dt">params1 =</span> l, <span class="dt">dist =</span> <span class="st">&quot;poisson&quot;</span>, <span class="dt">rho =</span> <span class="fl">0.3</span>, <span class="dt">corstr =</span> <span class="st">&quot;cs&quot;</span>, 
    <span class="dt">wide =</span> <span class="ot">TRUE</span>)
dx</code></pre></div>
<pre><code>##         id V1 V2 V3
##    1:    1  8 13  8
##    2:    2 12 13  9
##    3:    3 12 17 12
##    4:    4 11 15  9
##    5:    5  7 13 17
##   ---              
##  996:  996  9 11 12
##  997:  997  8 10 10
##  998:  998  6  6 12
##  999:  999  7  8 13
## 1000: 1000  9 10 13</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="kw">cor</span>(<span class="kw">as.matrix</span>(dx[, .(V1, V2, V3)])), <span class="dv">2</span>)</code></pre></div>
<pre><code>##      V1   V2   V3
## V1 1.00 0.32 0.32
## V2 0.32 1.00 0.29
## V3 0.32 0.29 1.00</code></pre>
<p>We can also generate correlated binary data by specifying the probabilities:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">genCorGen</span>(<span class="dv">1000</span>, <span class="dt">nvars =</span> <span class="dv">3</span>, <span class="dt">params1 =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>), <span class="dt">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="dt">rho =</span> <span class="fl">0.8</span>, 
    <span class="dt">corstr =</span> <span class="st">&quot;cs&quot;</span>, <span class="dt">wide =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##         id V1 V2 V3
##    1:    1  1  1  1
##    2:    2  0  1  1
##    3:    3  0  1  1
##    4:    4  0  0  0
##    5:    5  0  0  1
##   ---              
##  996:  996  0  1  1
##  997:  997  1  1  1
##  998:  998  1  1  1
##  999:  999  0  1  1
## 1000: 1000  0  0  0</code></pre>
<p>The gamma distribution requires two parameters - the mean and dispersion. (These are converted into shape and rate parameters more commonly used.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dx &lt;-<span class="st"> </span><span class="kw">genCorGen</span>(<span class="dv">1000</span>, <span class="dt">nvars =</span> <span class="dv">3</span>, <span class="dt">params1 =</span> l, <span class="dt">params2 =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">dist =</span> <span class="st">&quot;gamma&quot;</span>, 
    <span class="dt">rho =</span> <span class="fl">0.7</span>, <span class="dt">corstr =</span> <span class="st">&quot;cs&quot;</span>, <span class="dt">wide =</span> <span class="ot">TRUE</span>, <span class="dt">cnames =</span> <span class="st">&quot;a, b, c&quot;</span>)
dx</code></pre></div>
<pre><code>##         id          a          b          c
##    1:    1  2.2147914  5.7828970 12.4494947
##    2:    2  1.3062344  6.1613218  3.1724069
##    3:    3  4.8616340 29.6643309  6.4130084
##    4:    4  0.5403350  0.6539857  0.2711737
##    5:    5 12.4790275  3.3807058 14.2851746
##   ---                                      
##  996:  996  9.0188944  9.5958862  6.9818731
##  997:  997  1.0142999  2.5976399 13.4244831
##  998:  998  0.3335885  5.6766551  3.0571633
##  999:  999  3.4507202  2.6912672 16.6274046
## 1000: 1000 12.6529929  8.2262360 18.7148794</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="kw">cor</span>(<span class="kw">as.matrix</span>(dx[, .(a, b, c)])), <span class="dv">2</span>)</code></pre></div>
<pre><code>##      a    b    c
## a 1.00 0.67 0.67
## b 0.67 1.00 0.67
## c 0.67 0.67 1.00</code></pre>
<p>These data sets can be generated in either <em>wide</em> or <em>long</em> form. So far, we have generated <em>wide</em> form data, where there is one row per unique id. Now, we will generate data using the <em>long</em> form, where the correlated data are on different rows, so that there are repeated measurements for each id. An id will have multiple records (i.e. one id will appear on multiple rows):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dx &lt;-<span class="st"> </span><span class="kw">genCorGen</span>(<span class="dv">1000</span>, <span class="dt">nvars =</span> <span class="dv">3</span>, <span class="dt">params1 =</span> l, <span class="dt">params2 =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">dist =</span> <span class="st">&quot;gamma&quot;</span>, 
    <span class="dt">rho =</span> <span class="fl">0.7</span>, <span class="dt">corstr =</span> <span class="st">&quot;cs&quot;</span>, <span class="dt">wide =</span> <span class="ot">FALSE</span>, <span class="dt">cnames =</span> <span class="st">&quot;NewCol&quot;</span>)
dx</code></pre></div>
<pre><code>##         id period   NewCol
##    1:    1      0 4.618194
##    2:    1      1 6.364941
##    3:    1      2 4.994391
##    4:    2      0 1.616983
##    5:    2      1 2.628199
##   ---                     
## 2996:  999      1 5.019716
## 2997:  999      2 7.262344
## 2998: 1000      0 9.557948
## 2999: 1000      1 5.309435
## 3000: 1000      2 2.403630</code></pre>
<p><code>addCorGen</code> allows us to create correlated data from an existing data set, as one can already do using <code>addCorData</code>. In the case of <code>addCorGen</code>, the parameter(s) used to define the distribution are created as a field (or fields) in the dataset. The correlated data are added to the existing data set. In the example below, we are going to generate three sets (poisson, binary, and gamma) of correlated data with means that are a function of the variable <code>xbase</code>, which varies by id.</p>
<p>First we define the data and generate a data set:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">def &lt;-<span class="st"> </span><span class="kw">defData</span>(<span class="dt">varname =</span> <span class="st">&quot;xbase&quot;</span>, <span class="dt">formula =</span> <span class="dv">5</span>, <span class="dt">variance =</span> <span class="fl">0.2</span>, <span class="dt">dist =</span> <span class="st">&quot;gamma&quot;</span>, 
    <span class="dt">id =</span> <span class="st">&quot;cid&quot;</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;lambda&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;.5 + .1*xbase&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;nonrandom&quot;</span>, 
    <span class="dt">link =</span> <span class="st">&quot;log&quot;</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;-2 + .3*xbase&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;nonrandom&quot;</span>, 
    <span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;gammaMu&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;.5 + .2*xbase&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;nonrandom&quot;</span>, 
    <span class="dt">link =</span> <span class="st">&quot;log&quot;</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;gammaDis&quot;</span>, <span class="dt">formula =</span> <span class="dv">1</span>, <span class="dt">dist =</span> <span class="st">&quot;nonrandom&quot;</span>)

dt &lt;-<span class="st"> </span><span class="kw">genData</span>(<span class="dv">10000</span>, def)
dt</code></pre></div>
<pre><code>##          cid    xbase   lambda         p  gammaMu gammaDis
##     1:     1 5.698630 2.914980 0.4279032 5.153757        1
##     2:     2 3.564564 2.354802 0.2827968 3.363267        1
##     3:     3 2.664886 2.152196 0.2313802 2.809418        1
##     4:     4 5.678577 2.909141 0.4264312 5.133129        1
##     5:     5 5.369445 2.820585 0.4039179 4.825377        1
##    ---                                                    
##  9996:  9996 8.325959 3.790871 0.6219393 8.716273        1
##  9997:  9997 2.559089 2.129546 0.2257838 2.750596        1
##  9998:  9998 3.525356 2.345587 0.2804172 3.336997        1
##  9999:  9999 2.417845 2.099679 0.2184629 2.673982        1
## 10000: 10000 3.060428 2.239030 0.2531520 3.040694        1</code></pre>
<p>The Poisson distribution has a single parameter, lambda:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dtX1 &lt;-<span class="st"> </span><span class="kw">addCorGen</span>(<span class="dt">dtOld =</span> dt, <span class="dt">idvar =</span> <span class="st">&quot;cid&quot;</span>, <span class="dt">nvars =</span> <span class="dv">3</span>, <span class="dt">rho =</span> <span class="fl">0.1</span>, <span class="dt">corstr =</span> <span class="st">&quot;cs&quot;</span>, 
    <span class="dt">dist =</span> <span class="st">&quot;poisson&quot;</span>, <span class="dt">param1 =</span> <span class="st">&quot;lambda&quot;</span>, <span class="dt">cnames =</span> <span class="st">&quot;a, b, c&quot;</span>)
dtX1</code></pre></div>
<pre><code>##          cid    xbase   lambda         p  gammaMu gammaDis a b c
##     1:     1 5.698630 2.914980 0.4279032 5.153757        1 6 1 2
##     2:     2 3.564564 2.354802 0.2827968 3.363267        1 3 3 3
##     3:     3 2.664886 2.152196 0.2313802 2.809418        1 2 1 3
##     4:     4 5.678577 2.909141 0.4264312 5.133129        1 3 1 4
##     5:     5 5.369445 2.820585 0.4039179 4.825377        1 2 2 3
##    ---                                                          
##  9996:  9996 8.325959 3.790871 0.6219393 8.716273        1 4 4 6
##  9997:  9997 2.559089 2.129546 0.2257838 2.750596        1 1 3 3
##  9998:  9998 3.525356 2.345587 0.2804172 3.336997        1 0 2 1
##  9999:  9999 2.417845 2.099679 0.2184629 2.673982        1 1 2 2
## 10000: 10000 3.060428 2.239030 0.2531520 3.040694        1 3 0 2</code></pre>
<p>The Bernoulli (binary) distribution has a single parameter, p:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dtX2 &lt;-<span class="st"> </span><span class="kw">addCorGen</span>(<span class="dt">dtOld =</span> dt, <span class="dt">idvar =</span> <span class="st">&quot;cid&quot;</span>, <span class="dt">nvars =</span> <span class="dv">4</span>, <span class="dt">rho =</span> <span class="fl">0.4</span>, <span class="dt">corstr =</span> <span class="st">&quot;ar1&quot;</span>, 
    <span class="dt">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="dt">param1 =</span> <span class="st">&quot;p&quot;</span>)
dtX2</code></pre></div>
<pre><code>##          cid    xbase   lambda         p  gammaMu gammaDis V1 V2 V3 V4
##     1:     1 5.698630 2.914980 0.4279032 5.153757        1  0  0  1  0
##     2:     2 3.564564 2.354802 0.2827968 3.363267        1  1  1  0  1
##     3:     3 2.664886 2.152196 0.2313802 2.809418        1  0  0  0  0
##     4:     4 5.678577 2.909141 0.4264312 5.133129        1  1  0  0  0
##     5:     5 5.369445 2.820585 0.4039179 4.825377        1  1  1  1  1
##    ---                                                                
##  9996:  9996 8.325959 3.790871 0.6219393 8.716273        1  1  0  0  1
##  9997:  9997 2.559089 2.129546 0.2257838 2.750596        1  0  0  1  1
##  9998:  9998 3.525356 2.345587 0.2804172 3.336997        1  0  0  1  1
##  9999:  9999 2.417845 2.099679 0.2184629 2.673982        1  1  0  0  1
## 10000: 10000 3.060428 2.239030 0.2531520 3.040694        1  0  0  0  0</code></pre>
<p>The Gamma distribution has two parameters - in <code>simstudy</code> the mean and dispersion are specified:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dtX3 &lt;-<span class="st"> </span><span class="kw">addCorGen</span>(<span class="dt">dtOld =</span> dt, <span class="dt">idvar =</span> <span class="st">&quot;cid&quot;</span>, <span class="dt">nvars =</span> <span class="dv">4</span>, <span class="dt">rho =</span> <span class="fl">0.4</span>, <span class="dt">corstr =</span> <span class="st">&quot;cs&quot;</span>, 
    <span class="dt">dist =</span> <span class="st">&quot;gamma&quot;</span>, <span class="dt">param1 =</span> <span class="st">&quot;gammaMu&quot;</span>, <span class="dt">param2 =</span> <span class="st">&quot;gammaDis&quot;</span>)
dtX3</code></pre></div>
<pre><code>##          cid    xbase   lambda         p  gammaMu gammaDis        V1
##     1:     1 5.698630 2.914980 0.4279032 5.153757        1 2.1924081
##     2:     2 3.564564 2.354802 0.2827968 3.363267        1 8.7328677
##     3:     3 2.664886 2.152196 0.2313802 2.809418        1 2.7422032
##     4:     4 5.678577 2.909141 0.4264312 5.133129        1 4.3125713
##     5:     5 5.369445 2.820585 0.4039179 4.825377        1 4.6422097
##    ---                                                              
##  9996:  9996 8.325959 3.790871 0.6219393 8.716273        1 9.9600065
##  9997:  9997 2.559089 2.129546 0.2257838 2.750596        1 2.3437735
##  9998:  9998 3.525356 2.345587 0.2804172 3.336997        1 0.6124997
##  9999:  9999 2.417845 2.099679 0.2184629 2.673982        1 5.5975817
## 10000: 10000 3.060428 2.239030 0.2531520 3.040694        1 1.5432414
##               V2         V3        V4
##     1: 3.1822804 11.8429426 3.5030663
##     2: 0.8551908  8.4568344 3.7027966
##     3: 1.4664891  9.1577855 3.2776414
##     4: 2.5736640  1.9366756 1.6897873
##     5: 2.9348884  1.7149849 2.0216163
##    ---                               
##  9996: 1.7654044 13.4982386 4.2711241
##  9997: 4.6065786  4.6201099 1.7846534
##  9998: 1.3123053  0.7748302 1.9384933
##  9999: 4.4785144  1.3585290 5.6899324
## 10000: 3.8009607  0.1165655 0.5052408</code></pre>
<p>If we have data in <em>long</em> form (e.g. longitudinal data), the function will recognize the structure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">def &lt;-<span class="st"> </span><span class="kw">defData</span>(<span class="dt">varname =</span> <span class="st">&quot;xbase&quot;</span>, <span class="dt">formula =</span> <span class="dv">5</span>, <span class="dt">variance =</span> <span class="fl">0.4</span>, <span class="dt">dist =</span> <span class="st">&quot;gamma&quot;</span>, 
    <span class="dt">id =</span> <span class="st">&quot;cid&quot;</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="st">&quot;nperiods&quot;</span>, <span class="dt">formula =</span> <span class="dv">3</span>, <span class="dt">dist =</span> <span class="st">&quot;noZeroPoisson&quot;</span>)

def2 &lt;-<span class="st"> </span><span class="kw">defDataAdd</span>(<span class="dt">varname =</span> <span class="st">&quot;lambda&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;.5+.5*period + .1*xbase&quot;</span>, 
    <span class="dt">dist =</span> <span class="st">&quot;nonrandom&quot;</span>, <span class="dt">link =</span> <span class="st">&quot;log&quot;</span>)

dt &lt;-<span class="st"> </span><span class="kw">genData</span>(<span class="dv">1000</span>, def)

dtLong &lt;-<span class="st"> </span><span class="kw">addPeriods</span>(dt, <span class="dt">idvars =</span> <span class="st">&quot;cid&quot;</span>, <span class="dt">nPeriods =</span> <span class="dv">3</span>)
dtLong &lt;-<span class="st"> </span><span class="kw">addColumns</span>(def2, dtLong)

dtLong</code></pre></div>
<pre><code>##        cid period    xbase nperiods timeID   lambda
##    1:    1      0 4.419360        1      1 2.564942
##    2:    1      1 4.419360        1      2 4.228875
##    3:    1      2 4.419360        1      3 6.972236
##    4:    2      0 5.941155        2      4 2.986540
##    5:    2      1 5.941155        2      5 4.923972
##   ---                                              
## 2996:  999      1 3.365393        3   2996 3.805850
## 2997:  999      2 3.365393        3   2997 6.274785
## 2998: 1000      0 4.490924        5   2998 2.583364
## 2999: 1000      1 4.490924        5   2999 4.259247
## 3000: 1000      2 4.490924        5   3000 7.022311</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### Generate the data

dtX3 &lt;-<span class="st"> </span><span class="kw">addCorGen</span>(<span class="dt">dtOld =</span> dtLong, <span class="dt">idvar =</span> <span class="st">&quot;cid&quot;</span>, <span class="dt">nvars =</span> <span class="dv">3</span>, <span class="dt">rho =</span> <span class="fl">0.6</span>, <span class="dt">corstr =</span> <span class="st">&quot;cs&quot;</span>, 
    <span class="dt">dist =</span> <span class="st">&quot;poisson&quot;</span>, <span class="dt">param1 =</span> <span class="st">&quot;lambda&quot;</span>, <span class="dt">cnames =</span> <span class="st">&quot;NewPois&quot;</span>)
dtX3</code></pre></div>
<pre><code>##        cid period    xbase nperiods timeID   lambda NewPois
##    1:    1      0 4.419360        1      1 2.564942       0
##    2:    1      1 4.419360        1      2 4.228875       3
##    3:    1      2 4.419360        1      3 6.972236       4
##    4:    2      0 5.941155        2      4 2.986540       3
##    5:    2      1 5.941155        2      5 4.923972       4
##   ---                                                      
## 2996:  999      1 3.365393        3   2996 3.805850       7
## 2997:  999      2 3.365393        3   2997 6.274785       9
## 2998: 1000      0 4.490924        5   2998 2.583364       3
## 2999: 1000      1 4.490924        5   2999 4.259247       6
## 3000: 1000      2 4.490924        5   3000 7.022311      10</code></pre>
<p>We can fit a generalized estimating equation (GEE) model and examine the coefficients and the working correlation matrix. They match closely to the data generating parameters:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geefit &lt;-<span class="st"> </span><span class="kw">gee</span>(NewPois <span class="op">~</span><span class="st"> </span>period <span class="op">+</span><span class="st"> </span>xbase, <span class="dt">data =</span> dtX3, <span class="dt">id =</span> cid, <span class="dt">family =</span> poisson, 
    <span class="dt">corstr =</span> <span class="st">&quot;exchangeable&quot;</span>)</code></pre></div>
<pre><code>## Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</code></pre>
<pre><code>## running glm to get initial regression estimate</code></pre>
<pre><code>## (Intercept)      period       xbase 
##   0.4958892   0.5062428   0.0993127</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="kw">summary</span>(geefit)<span class="op">$</span>working.correlation, <span class="dv">2</span>)</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,] 1.00 0.58 0.58
## [2,] 0.58 1.00 0.58
## [3,] 0.58 0.58 1.00</code></pre>
</div>
</div>
<div id="missing-data" class="section level2">
<h2>Missing data</h2>
<p>After generating a complete data set, it is possible to generate missing data. <code>defMiss</code> defines the parameters of missingness. <code>genMiss</code> generates a missing data matrix of indicators for each field. Indicators are set to 1 if the data are missing for a subject, 0 otherwise. <code>genObs</code> creates a data set that reflects what would have been observed had data been missing; this is a replicate of the original data set with “NAs” replacing values where missing data has been generated.</p>
<p>By controlling the parameters of missingness, it is possible to represent different missing data mechanisms: (1) <em>missing completely at random</em> (MCAR), where the probability missing data is independent of any covariates, measured or unmeasured, that are associated with the measure, (2) <em>missing at random</em> (MAR), where the probability of subject missing data is a function only of observed covariates that are associated with the measure, and (3) <em>not missing at random</em> (NMAR), where the probability of missing data is related to unmeasured covariates that are associated with measure.</p>
<p>These possibilities are illustrated with an example. A data set of 1000 observations with three “outcome” measures&quot; <code>x1</code>, <code>x2</code>, and <code>x3</code> is defined. This data set also includes two independent predictors, <code>m</code> and <code>u</code> that largely determine the value of each outcome (subject to random noise).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">def1 &lt;-<span class="st"> </span><span class="kw">defData</span>(<span class="dt">varname =</span> <span class="st">&quot;m&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="dt">formula =</span> <span class="fl">0.5</span>)
def1 &lt;-<span class="st"> </span><span class="kw">defData</span>(def1, <span class="st">&quot;u&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="dt">formula =</span> <span class="fl">0.5</span>)
def1 &lt;-<span class="st"> </span><span class="kw">defData</span>(def1, <span class="st">&quot;x1&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;20*m + 20*u&quot;</span>, <span class="dt">variance =</span> <span class="dv">2</span>)
def1 &lt;-<span class="st"> </span><span class="kw">defData</span>(def1, <span class="st">&quot;x2&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;20*m + 20*u&quot;</span>, <span class="dt">variance =</span> <span class="dv">2</span>)
def1 &lt;-<span class="st"> </span><span class="kw">defData</span>(def1, <span class="st">&quot;x3&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;20*m + 20*u&quot;</span>, <span class="dt">variance =</span> <span class="dv">2</span>)

dtAct &lt;-<span class="st"> </span><span class="kw">genData</span>(<span class="dv">1000</span>, def1)</code></pre></div>
<p>In this example, the missing data mechanism is different for each outcome. As defined below, missingness for <code>x1</code> is MCAR, since the probability of missing is fixed. Missingness for <code>x2</code> is MAR, since missingness is a function of <code>m</code>, a measured predictor of <code>x2</code>. And missingness for <code>x3</code> is NMAR, since the probability of missing is dependent on <code>u</code>, an unmeasured predictor of <code>x3</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">defM &lt;-<span class="st"> </span><span class="kw">defMiss</span>(<span class="dt">varname =</span> <span class="st">&quot;x1&quot;</span>, <span class="dt">formula =</span> <span class="fl">0.15</span>, <span class="dt">logit.link =</span> <span class="ot">FALSE</span>)
defM &lt;-<span class="st"> </span><span class="kw">defMiss</span>(defM, <span class="dt">varname =</span> <span class="st">&quot;x2&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;.05 + m * 0.25&quot;</span>, <span class="dt">logit.link =</span> <span class="ot">FALSE</span>)
defM &lt;-<span class="st"> </span><span class="kw">defMiss</span>(defM, <span class="dt">varname =</span> <span class="st">&quot;x3&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;.05 + u * 0.25&quot;</span>, <span class="dt">logit.link =</span> <span class="ot">FALSE</span>)
defM &lt;-<span class="st"> </span><span class="kw">defMiss</span>(defM, <span class="dt">varname =</span> <span class="st">&quot;u&quot;</span>, <span class="dt">formula =</span> <span class="dv">1</span>, <span class="dt">logit.link =</span> <span class="ot">FALSE</span>)  <span class="co"># not observed</span>

missMat &lt;-<span class="st"> </span><span class="kw">genMiss</span>(<span class="dt">dtName =</span> dtAct, <span class="dt">missDefs =</span> defM, <span class="dt">idvars =</span> <span class="st">&quot;id&quot;</span>)
dtObs &lt;-<span class="st"> </span><span class="kw">genObs</span>(dtAct, missMat, <span class="dt">idvars =</span> <span class="st">&quot;id&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">missMat</code></pre></div>
<pre><code>##         id x1 x2 x3 u m
##    1:    1  0  1  0 1 0
##    2:    2  0  0  0 1 0
##    3:    3  0  0  0 1 0
##    4:    4  0  0  0 1 0
##    5:    5  0  0  0 1 0
##   ---                  
##  996:  996  0  0  0 1 0
##  997:  997  0  0  0 1 0
##  998:  998  0  0  0 1 0
##  999:  999  0  0  0 1 0
## 1000: 1000  0  0  0 1 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dtObs</code></pre></div>
<pre><code>##         id m  u         x1          x2          x3
##    1:    1 0 NA  0.4897648          NA -0.41784137
##    2:    2 0 NA  0.7115354  0.44336010  0.09161338
##    3:    3 0 NA -2.0015986  1.14532572  2.27791736
##    4:    4 1 NA 17.6922028 18.87469486 18.56019618
##    5:    5 1 NA 20.3853462 19.39040578 19.32114600
##   ---                                             
##  996:  996 0 NA -2.1475359 -0.16479811  0.31246825
##  997:  997 0 NA  1.1448311  0.08416758 -1.09136051
##  998:  998 1 NA 41.3487531 39.62171697 38.85677524
##  999:  999 0 NA -1.1410528 -0.37949988  0.79642002
## 1000: 1000 0 NA -0.4259718 -0.74783361 -0.63368629</code></pre>
<p>The impacts of the various data mechanisms on estimation can be seen with a simple calculation of means using both the “true” data set without missing data as a comparison for the “observed” data set. Since <code>x1</code> is MCAR, the averages for both data sets are roughly equivalent. However, we can see below that estimates for <code>x2</code> and <code>x3</code> are biased, as the difference between observed and actual is not close to 0:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Two functions to calculate means and compare them</span>

rmean &lt;-<span class="st"> </span><span class="cf">function</span>(var, <span class="dt">digits =</span> <span class="dv">1</span>) {
    <span class="kw">round</span>(<span class="kw">mean</span>(var, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), digits)
}

showDif &lt;-<span class="st"> </span><span class="cf">function</span>(dt1, dt2, <span class="dt">rowName =</span> <span class="kw">c</span>(<span class="st">&quot;Actual&quot;</span>, <span class="st">&quot;Observed&quot;</span>, <span class="st">&quot;Difference&quot;</span>)) {
    dt &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">rbind</span>(dt1, dt2, dt1 <span class="op">-</span><span class="st"> </span>dt2))
    <span class="kw">rownames</span>(dt) &lt;-<span class="st"> </span>rowName
    <span class="kw">return</span>(dt)
}

<span class="co"># data.table functionality to estimate means for each data set</span>

meanAct &lt;-<span class="st"> </span>dtAct[, .(<span class="dt">x1 =</span> <span class="kw">rmean</span>(x1), <span class="dt">x2 =</span> <span class="kw">rmean</span>(x2), <span class="dt">x3 =</span> <span class="kw">rmean</span>(x3))]
meanObs &lt;-<span class="st"> </span>dtObs[, .(<span class="dt">x1 =</span> <span class="kw">rmean</span>(x1), <span class="dt">x2 =</span> <span class="kw">rmean</span>(x2), <span class="dt">x3 =</span> <span class="kw">rmean</span>(x3))]

<span class="kw">showDif</span>(meanAct, meanObs)</code></pre></div>
<pre><code>##              x1   x2   x3
## Actual     20.1 20.1 20.1
## Observed   20.2 18.3 18.5
## Difference -0.1  1.8  1.6</code></pre>
<p>After adjusting for the measured covariate <code>m</code>, the bias for the estimate of the mean of <code>x2</code> is mitigated, but not for <code>x3</code>, since <code>u</code> is not observed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">meanActm &lt;-<span class="st"> </span>dtAct[, .(<span class="dt">x1 =</span> <span class="kw">rmean</span>(x1), <span class="dt">x2 =</span> <span class="kw">rmean</span>(x2), <span class="dt">x3 =</span> <span class="kw">rmean</span>(x3)), keyby =<span class="st"> </span>m]
meanObsm &lt;-<span class="st"> </span>dtObs[, .(<span class="dt">x1 =</span> <span class="kw">rmean</span>(x1), <span class="dt">x2 =</span> <span class="kw">rmean</span>(x2), <span class="dt">x3 =</span> <span class="kw">rmean</span>(x3)), keyby =<span class="st"> </span>m]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># compare observed and actual when m = 0</span>

<span class="kw">showDif</span>(meanActm[m <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, .(x1, x2, x3)], meanObsm[m <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, .(x1, x2, x3)])</code></pre></div>
<pre><code>##              x1   x2   x3
## Actual     10.3 10.2 10.3
## Observed   10.3 10.2  8.8
## Difference  0.0  0.0  1.5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># compare observed and actual when m = 1</span>

<span class="kw">showDif</span>(meanActm[m <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, .(x1, x2, x3)], meanObsm[m <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, .(x1, x2, x3)])</code></pre></div>
<pre><code>##              x1   x2   x3
## Actual     29.9 29.9 29.8
## Observed   30.1 29.3 28.2
## Difference -0.2  0.6  1.6</code></pre>
</div>
<div id="longitudinal-data-with-missingness" class="section level2">
<h2>Longitudinal data with missingness</h2>
<p>Missingness can occur, of course, in the context of longitudinal data. <code>missDef</code> provides two additional arguments that are relevant for these types of data: <code>baseline</code> and <code>monotonic</code>. In the case of variables that are measured at baseline only, a missing value would be reflected throughout the course of the study. In the case where a variable is time-dependent (i.e it is measured at each time point), it is possible to declare missingness to be <em>monotonic</em>. This means that if a value for this field is missing at time <code>t</code>, then values will also be missing at all times <code>T &gt; t</code> as well. The call to <code>genMiss</code> must set <code>repeated</code> to TRUE.</p>
<p>The following two examples describe an outcome variable <code>y</code> that is measured over time, whose value is a function of time and an observed exposure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># use baseline definitions from previous example</span>

dtAct &lt;-<span class="st"> </span><span class="kw">genData</span>(<span class="dv">120</span>, def1)
dtAct &lt;-<span class="st"> </span><span class="kw">trtObserve</span>(dtAct, <span class="dt">formulas =</span> <span class="fl">0.5</span>, <span class="dt">logit.link =</span> <span class="ot">FALSE</span>, <span class="dt">grpName =</span> <span class="st">&quot;rx&quot;</span>)

<span class="co"># add longitudinal data</span>

defLong &lt;-<span class="st"> </span><span class="kw">defDataAdd</span>(<span class="dt">varname =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;10 + period*2 + 2 * rx&quot;</span>, 
    <span class="dt">variance =</span> <span class="dv">2</span>)

dtTime &lt;-<span class="st"> </span><span class="kw">addPeriods</span>(dtAct, <span class="dt">nPeriods =</span> <span class="dv">4</span>)
dtTime &lt;-<span class="st"> </span><span class="kw">addColumns</span>(defLong, dtTime)</code></pre></div>
<p>In the first case, missingness is not monotonic; a subject might miss a measurement but returns for subsequent measurements:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># missingness for y is not monotonic</span>

defMlong &lt;-<span class="st"> </span><span class="kw">defMiss</span>(<span class="dt">varname =</span> <span class="st">&quot;x1&quot;</span>, <span class="dt">formula =</span> <span class="fl">0.2</span>, <span class="dt">baseline =</span> <span class="ot">TRUE</span>)
defMlong &lt;-<span class="st"> </span><span class="kw">defMiss</span>(defMlong, <span class="dt">varname =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;-1.5 - 1.5 * rx + .25*period&quot;</span>, 
    <span class="dt">logit.link =</span> <span class="ot">TRUE</span>, <span class="dt">baseline =</span> <span class="ot">FALSE</span>, <span class="dt">monotonic =</span> <span class="ot">FALSE</span>)

missMatLong &lt;-<span class="st"> </span><span class="kw">genMiss</span>(<span class="dt">dtName =</span> dtTime, <span class="dt">missDefs =</span> defMlong, <span class="dt">idvars =</span> <span class="kw">c</span>(<span class="st">&quot;id&quot;</span>, 
    <span class="st">&quot;rx&quot;</span>), <span class="dt">repeated =</span> <span class="ot">TRUE</span>, <span class="dt">periodvar =</span> <span class="st">&quot;period&quot;</span>)</code></pre></div>
<p>Here is a conceptual plot that shows the pattern of missingness. Each row represents an individual, and each box represents a time period. A box that is colored reflects missing data; a box colored grey reflects observed. The missingness pattern is shown for two variables <code>x1</code> and <code>y</code>:</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In the second case, missingness is monotonic; once a subject misses a measurement for <code>y</code>, there are no subsequent measurements:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># missingness for y is not monotonic</span>

defMlong &lt;-<span class="st"> </span><span class="kw">defMiss</span>(<span class="dt">varname =</span> <span class="st">&quot;x1&quot;</span>, <span class="dt">formula =</span> <span class="fl">0.2</span>, <span class="dt">baseline =</span> <span class="ot">TRUE</span>)
defMlong &lt;-<span class="st"> </span><span class="kw">defMiss</span>(defMlong, <span class="dt">varname =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;-1.8 - 1.5 * rx + .25*period&quot;</span>, 
    <span class="dt">logit.link =</span> <span class="ot">TRUE</span>, <span class="dt">baseline =</span> <span class="ot">FALSE</span>, <span class="dt">monotonic =</span> <span class="ot">TRUE</span>)

missMatLong &lt;-<span class="st"> </span><span class="kw">genMiss</span>(<span class="dt">dtName =</span> dtTime, <span class="dt">missDefs =</span> defMlong, <span class="dt">idvars =</span> <span class="kw">c</span>(<span class="st">&quot;id&quot;</span>, 
    <span class="st">&quot;rx&quot;</span>), <span class="dt">repeated =</span> <span class="ot">TRUE</span>, <span class="dt">periodvar =</span> <span class="st">&quot;period&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="spline-data" class="section level2">
<h2>Spline data</h2>
<p>Sometimes (usually?) relationships between variables are non-linear. <code>simstudy</code> can already accommodate that. But, if we want to explicitly generate data from a piece-wise polynomial function to explore spline methods in particular, or non-linear relationships more generally. There are three functions that facilitate this: <code>viewBasis</code>, <code>viewSplines</code>, and <code>genSpline</code>. The first two functions are more exploratory in nature, and just provide plots of the B-spline basis functions and the splines, respectively. The third function actually generates data and adds to an existing data.table.</p>
<p>The shape of a spline is determined by three factors: (1) the cut-points or knots that define the piecewise structure of the function, (2) the polynomial degree, such as linear, quadratic, cubic, etc., and (3) the linear coefficients that combine the basis functions, which is contained in a vector or matrix <em>theta</em>.</p>
<p>First, we can look at the basis functions, we depend only the knots and degree. The knots are specified as quantiles, between 0 and 1:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knots &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)
<span class="kw">viewBasis</span>(knots, <span class="dt">degree =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knots &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>)
<span class="kw">viewBasis</span>(knots, <span class="dt">degree =</span> <span class="dv">3</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The splines themselves are specified as linear combinations of each of the basis functions. The coefficients of those combinations are specified in <em>theta</em>. Each individual spline curve represents a specific linear combination of a particular set of basis functions. In exploring, we can look at a single curve or multiple curves, depending on whether or not we specify theta as a vector (single) or matrix (multiple).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knots &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)

<span class="co"># number of elements in theta: length(knots) + degree + 1</span>
theta1 =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>, <span class="fl">0.4</span>, <span class="fl">0.9</span>, <span class="fl">0.2</span>, <span class="dv">1</span>)

<span class="kw">viewSplines</span>(knots, <span class="dt">degree =</span> <span class="dv">2</span>, theta1)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">theta2 =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.9</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.8</span>, <span class="dv">1</span>, 
    <span class="fl">0.9</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.6</span>, <span class="fl">0.1</span>), <span class="dt">ncol =</span> <span class="dv">3</span>)

theta2</code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  0.1  0.1  0.1
## [2,]  0.2  0.3  0.9
## [3,]  0.4  0.3  0.8
## [4,]  0.9  0.8  0.2
## [5,]  0.2  1.0  0.1
## [6,]  0.3  0.9  0.6
## [7,]  0.6  0.4  0.1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">viewSplines</span>(knots, <span class="dt">degree =</span> <span class="dv">3</span>, theta2)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can generate data using a predictor in an existing data set by specifying the <em>knots</em> (in terms of quantiles), a vector of coefficients in <em>theta</em>, the degree of polynomial, as well as a range</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ddef &lt;-<span class="st"> </span><span class="kw">defData</span>(<span class="dt">varname =</span> <span class="st">&quot;age&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;20;60&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;uniform&quot;</span>)

theta1 =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span>, <span class="fl">0.9</span>)
knots &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)</code></pre></div>
<p>Here is the shape of the curve that we want to generate data from:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">viewSplines</span>(<span class="dt">knots =</span> knots, <span class="dt">theta =</span> theta1, <span class="dt">degree =</span> <span class="dv">3</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now we specify the variables in the data set and generate the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">234</span>)
dt &lt;-<span class="st"> </span><span class="kw">genData</span>(<span class="dv">1000</span>, ddef)
dt &lt;-<span class="st"> </span><span class="kw">genSpline</span>(<span class="dt">dt =</span> dt, <span class="dt">newvar =</span> <span class="st">&quot;weight&quot;</span>, <span class="dt">predictor =</span> <span class="st">&quot;age&quot;</span>, <span class="dt">theta =</span> theta1, 
    <span class="dt">knots =</span> knots, <span class="dt">degree =</span> <span class="dv">3</span>, <span class="dt">newrange =</span> <span class="st">&quot;90;160&quot;</span>, <span class="dt">noise.var =</span> <span class="dv">64</span>)</code></pre></div>
<p>Here’s a plot of the data with a smoothed line fit to the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> dt, <span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;grey65&quot;</span>, <span class="dt">size =</span> <span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">method =</span> <span class="st">&quot;auto&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">quantile</span>(dt<span class="op">$</span>age, 
    knots)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Finally, we will fit three different spline models to the data - a linear, a quadratic, and a cubic - and plot the predicted values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># normalize age for best basis functions</span>
dt[, <span class="st">`</span><span class="dt">:=</span><span class="st">`</span>(nage, (age <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(age))<span class="op">/</span>(<span class="kw">max</span>(age) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(age)))]

<span class="co"># fit a cubic spline</span>
lmfit3 &lt;-<span class="st"> </span><span class="kw">lm</span>(weight <span class="op">~</span><span class="st"> </span><span class="kw">bs</span>(<span class="dt">x =</span> nage, <span class="dt">knots =</span> knots, <span class="dt">degree =</span> <span class="dv">3</span>, <span class="dt">intercept =</span> <span class="ot">TRUE</span>) <span class="op">-</span><span class="st"> </span>
<span class="st">    </span><span class="dv">1</span>, <span class="dt">data =</span> dt)

<span class="co"># fit a quadtratic spline</span>
lmfit2 &lt;-<span class="st"> </span><span class="kw">lm</span>(weight <span class="op">~</span><span class="st"> </span><span class="kw">bs</span>(<span class="dt">x =</span> nage, <span class="dt">knots =</span> knots, <span class="dt">degree =</span> <span class="dv">2</span>), <span class="dt">data =</span> dt)

<span class="co"># fit a linear spline</span>
lmfit1 &lt;-<span class="st"> </span><span class="kw">lm</span>(weight <span class="op">~</span><span class="st"> </span><span class="kw">bs</span>(<span class="dt">x =</span> nage, <span class="dt">knots =</span> knots, <span class="dt">degree =</span> <span class="dv">1</span>), <span class="dt">data =</span> dt)

<span class="co"># add predicted values for plotting</span>
dt[, <span class="st">`</span><span class="dt">:=</span><span class="st">`</span>(pred.3deg, <span class="kw">predict</span>(lmfit3))]
dt[, <span class="st">`</span><span class="dt">:=</span><span class="st">`</span>(pred.2deg, <span class="kw">predict</span>(lmfit2))]
dt[, <span class="st">`</span><span class="dt">:=</span><span class="st">`</span>(pred.1deg, <span class="kw">predict</span>(lmfit1))]

<span class="kw">ggplot</span>(<span class="dt">data =</span> dt, <span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;grey65&quot;</span>, <span class="dt">size =</span> <span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> pred.3deg), <span class="dt">color =</span> <span class="st">&quot;#1B9E77&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age, 
    <span class="dt">y =</span> pred.2deg), <span class="dt">color =</span> <span class="st">&quot;#D95F02&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> pred.1deg), 
    <span class="dt">color =</span> <span class="st">&quot;#7570B3&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">quantile</span>(dt<span class="op">$</span>age, 
    knots)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
